---
id: "malware-analysis-simplehelp-rmm"
title: "Análise de Malware: Como o abuso de ferramentas de suporte remoto (RMM) permite o controle e infecção de dispositivos"
date: "14/01/2026"
tags: ["Malware Analysis", "RMM Abuse", "UAC Bypass", "Threat Hunting", "Persistence"]
description: "Análise técnica de um executável malicioso recebido via phishing que utiliza técnicas de UAC Bypass e ferramentas de RMM legítimas (SimpleHelp) para estabelecer persistência e acesso remoto."
---

# Contexto

Hoje, **dia 14/01/2026** recebi um e-mail de phishing clássico cujo tema era o envio de faturas e demonstrativos ("Statements"). O link levava a uma aplicação que se passava por um órgão governamental legítimo e apresentava um comportamento interessante: o site de origem possuía filtros de ambiente e só permitia o download em sistemas Windows. Resolvi baixar a amostra `statments97854.exe` para análise em ambiente controlado.

O malware demonstrou não ser um artefato tão simples; ele utiliza técnicas de **Living off the Land (LotL)** e abusa de ferramentas de **RMM (Remote Monitoring and Management)** legítimas para ocultar sua presença e garantir acesso remoto persistente sob uma fachada de um software legítimo.

# Algumas informações sobre a amostra

- **Nome:** `statments97854.exe`
- **Tamanho:** 1.6MB
- **MD5:** `305aa35f183b61e8b15be076ba7fcd77`
- **SHA256:** `c2b4af793c0efeb7cd7306486039ee1f1ad46aff75ab74bb7f24ef0252390f0d`
- **Veredito:** Malicious Activity (Score 8/10 no Triage / Malicious no Any.Run)

# Cadeia de execução

A análise do comportamento mostra uma árvore de processos complexa, iniciando com um dropper baseado em Java (JWrapper) que prepara o terreno para a invasão:

```text
statments97854.exe
├── slui.exe -> (UAC Bypass via Windows Activation)
├── unpack200.exe -> (Descompactação de componentes JAR)
├── netsh.exe -> (Manipulação de regras de Firewall)
├── SimpleService.exe -> (Instalação de persistência)
└── ScreenConnect/SimpleHelp (Payload final -> Acesso Remoto)
```
# Escalação de Privilégios (UAC Bypass)

O malware executa o binário nativo `C:\Windows\System32\slui.exe`. Esta é uma técnica utilizada para herdar privilégios administrativos (Integridade Nível HIGH) sem disparar o alerta visual do UAC, permitindo que o atacante modifique configurações críticas do sistema silenciosamente.

# Persistência e Evasão de Defesa

O atacante utiliza métodos de administração de sistemas Windows para garantir sua permanência no host:
**Manipulação de Permissões (ACLs):** O uso do `cacls.exe` foi detectado para forçar permissões de controle total (`Users:F`) nas pastas de instalação em `C:\ProgramData\JWrapper-Remote Access\`, impedindo que o sistema ou o usuário bloqueiem o acesso aos seus componentes.

**Modificação do Firewall (MITRE T1562.004):** Através do utilitário `netsh.exe`, o malware cria regras de entrada específicas para permitir o tráfego da ferramenta de RMM:

  ```cmd netsh advfirewall firewall add rule "name=SH Remote Access Service" "description=Inbound rule for the Remote Access Service to facilitate access sessions" dir=in action=allow "program=C:\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00063527423-complete\bin\Remote Access.exe"```

  ```cmd netsh advfirewall firewall add rule "name=SH Remote Access Service Updater" "description=Inbound rule for the Remote Access Service updater" dir=in action=allow "program=C:\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00063527423-complete\bin\Remote AccessECompatibility.exe"```

  ```cmd netsh advfirewall firewall add rule "name=SH Remote Access Service Launcher" "description=Inbound rule for the launcher that can spawn the Remote Access Service" dir=in action=allow "program=C:\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00063527423-complete\bin\Remote AccessLauncher.exe"```

**Persistência via Serviço (T1543.003):** O binário `SimpleService.exe` é instalado como um serviço do Windows, garantindo que o agente de acesso remoto inicie automaticamente em cada boot do sistema.

## Análise de Rede e Reconhecimento

O estágio inicial realiza um reconhecimento (Discovery) completo do host antes de estabilizar a conexão com o C2:

**Discovery:** Utiliza `wmic.exe` para identificar o software antivírus, antispyware e a solução de firewall ativa no alvo através do namespace `SecurityCenter2`.

**Identificação de Rede:** Comandos como `netstat -ano` e `netsh wlan show interfaces` mapeiam a infraestrutura de rede da vítima para identificar o ambiente (sandbox vs alvo real).

**Tráfego C2:** Identifiquei requisições HTTP para o IP `151.242.63.244` na porta `8888`. Um detalhe técnico relevante é o User-Agent customizado utilizado para o download dos componentes adicionais: `JWrapperDownloader`.

## Indicadores de Comprometimento (IoCs)
- **IPs (conexões realizadas):** `51.242.63.244, 2.16.241.12, 51.124.78.146, 23.59.18.102`
- **IP de Comando e Controle:** `151.242.63.244` (Porta 8888)
- **Domínio Relacionado:** `statsonlineviewdetails.com`
- **SHA256:** `c2b4af793c0efeb7cd7306486039ee1f1ad46aff75ab74bb7f24ef0252390f0d`
- **User-Agent:** `JWrapperDownloader`

## Conclusão

A análise da amostra confirma que estamos diante de um ataque de **Malicious RMM**. Em vez de utilizar um payload ofensivo imediato, o atacante optou por instalar uma instância legítima do software **SimpleHelp/ScreenConnect**.

### Pontos chaves:

**Abuso de Confiança:** Ao utilizar ferramentas de suporte remoto profissionais, o atacante contorna detecções baseadas em assinaturas, já que os binários possuem certificados válidos e propósitos legítimos.

**Técnicas LotL:** O uso de `slui.exe`, `netsh.exe` e `cacls.exe` demonstra um esforço claro em utilizar as próprias ferramentas do Windows para realizar a infecção, dificultando a distinção entre uma atividade legítima e um ataque.


# Imagens

![Email](/images/email_statements.PNG)

![Anyrun](/images/anyrun_statments.PNG)

![Triage](/images/triage_statements.PNG)

